STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 1  Assembler
                                               d:\stm8\dbg1\main.asm

   1                         stm8/     
   2                         
   0  000000                                 #include "mapping.inc"
   1                                                          ;-------------------------------
                                                                ;-----------------------
   2                                                          ; SEGMENT MAPPING FILE 
                                                                ;AUTOMATICALLY GENERATED BY 
                                                                ;STVD
   3                                                          ; SHOULD NOT BE MANUALLY 
                                                                ;MODIFIED.
   4                                                          ; CHANGES WILL BE LOST WHEN FILE
                                                                ; IS REGENERATED.
   5                                                          ;-------------------------------
                                                                ;-----------------------
   6  000000                                 #define  RAM0 1
   7  000000                                 #define  ram0_segment_start 0
   8  000000                                 #define  ram0_segment_end FF
   9  000000                                 #define  RAM1 1
  10  000000                                 #define  ram1_segment_start 100
  11  000000                                 #define  ram1_segment_end 1FF
  12  000000                                 #define  stack_segment_start 200
  13  000000                                 #define  stack_segment_end 3FF
<END_OF_INCLUSION>
   0  000000                                 #include "stm8s003f3.inc"
   1                         ;----STM8S003F3 peripherial define file
   2                         ;--Registers of the MCU:
   3                                   
   4                                                          ;---CLK-----
   5  000000                                 #define  CLK_ICKR      $50C0;
   6  000000                                 #define  CLK_ECKR      $50C1;
   7  000000                                 #define  CLK_CMSR      $50C3;
   8  000000                                 #define  CLK_SWR       $50C4;
   9  000000                                 #define  CLK_SWCR      $50C5;
  10  000000                                 #define  CLK_CKDIVR    $50C6;
  11  000000                                 #define  CLK_PCKENR1    $50C7;
  12  000000                                 #define  CLK_CSSR       $50C8;
  13  000000                                 #define  CLK_CCOR       $50C9;
  14  000000                                 #define  CLK_PCKENR2    $50CA;
  15                                   
  16  000000                                 #define  HSERDY        #$02
  17  000000                                 #define  HSEEN         #$01
  18                                   
  19  000000                                 #define  SWIF    #$08 
  20  000000                                 #define  SWIEN         #$04
  21  000000                                 #define  SWEN          #$02
  22  000000                                 #define  SWBSY   #$01
  23                                   
  24  000000                                 #define  HSIDIV_1 #$00
  25  000000                                 #define  HSIDIV_2 #$08
  26  000000                                 #define  HSIDIV_4 #$10
  27  000000                                 #define  HSIDIV_8 #$18
  28                                   
  29  000000                                 #define  CPUDIV_1 #$00
  30  000000                                 #define  CPUDIV_2 #$01
  31  000000                                 #define  CPUDIV_4 #$02
  32  000000                                 #define  CPUDIV_8 #$03
  33  000000                                 #define  CPUDIV_16 #$04
  34  000000                                 #define  CPUDIV_32 #$05
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 2  Assembler
                                               d:\stm8\dbg1\main.asm

  35  000000                                 #define  CPUDIV_64 #$06
  36  000000                                 #define  CPUDIV_128 #$07
  37                                                          ;-------ITC------
  38  000000                                 #define  EXTI_CR1  $50A0  ;
  39  000000                                 #define  EXTI_CR2  $50A1  ;
  40                                                          ;----FLASH-------
  41  000000                                 #define  FLASH_CR1 $505A  ;
  42  000000                                 #define  FLASH_CR2 $505B  ;
  43  000000                                 #define  LASH_NCR2 $505C  ;
  44  000000                                 #define  FLASH_FPR $505D  ;
  45  000000                                 #define  FLASH _NFPR $505E  ; 	
  46  000000                                 #define  _NFPR $505E _IAPSR $505F  ;
  47                                                          ;--------PORT A-----
  48  000000                                 #define  PA_ODR        $5000;
  49  000000                                 #define  PA_IDR        $5001;
  50  000000                                 #define  PA_DDR        $5002;
  51  000000                                 #define  PA_CR1        $5003;
  52  000000                                 #define  PA_CR2  $5004  ;
  53                                                          ;--------PORT B------
  54  000000                                 #define  PB_ODR        $5005;
  55  000000                                 #define  PB_IDR        $5006;
  56  000000                                 #define  PB_DDR        $5007;
  57  000000                                 #define  PB_CR1        $5008;
  58  000000                                 #define  PB_CR2        $5009;
  59                                                          ;---------PORT  C-----
  60  000000                                 #define  PC_ODR        $500A;
  61  000000                                 #define  PC_IDR        $500B;
  62  000000                                 #define  PC_DDR        $500C;
  63  000000                                 #define  PC_CR1        $500D;
  64  000000                                 #define  PC_CR2        $500E;
  65                                   
  66                                                          ;----PORT D-------
  67  000000                                 #define  PD_ODR        $500F;
  68  000000                                 #define  PD_IDR        $5010;
  69  000000                                 #define  PD_DDR        $5011;
  70  000000                                 #define  PD_CR1        $5012;
  71  000000                                 #define  PD_CR2        $5013;
  72                                                          ;--------PORT E-------
  73  000000                                 #define  PE_ODR        $5014;
  74  000000                                 #define  PE_IDR        $5015;
  75  000000                                 #define  PE_DDR        $5016;
  76  000000                                 #define  PE_CR1        $5017;
  77  000000                                 #define  PE_CR2        $5018;
  78                                                          ;---------PORT F------
  79  000000                                 #define  PF_ODR        $5019;
  80  000000                                 #define  PF_IDR        $501A;
  81  000000                                 #define  PF_DDR        $501B;
  82  000000                                 #define  PF_CR1        $501C;
  83  000000                                 #define  PF_CR2        $501D;
  84                                                          ;------ITC---------
  85  000000                                 #define  $50A0 $50A0   ;
  86  000000                                 #define  $50A1 $50A1   ;
  87                                                          ;--------TIM 1----------
  88  000000                                 #define  TIM1_CR1  $5250  ;
  89  000000                                 #define  TIM1_CR2  $5251  ;
  90  000000                                 #define  TIM1_SMCR $5252  ;
  91  000000                                 #define  TIM1_ETR  $5253  ;
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 3  Assembler
                                               d:\stm8\dbg1\main.asm

  92  000000                                 #define  TIM1_IER  $5254  ;
  93  000000                                 #define  TIM1_SR1  $5255  ;
  94  000000                                 #define  TIM1_SR2  $5256  ;
  95  000000                                 #define  TIM1_EGR  $5257  ;
  96  000000                                 #define  TIM1_CCMR1 $5258  ;
  97  000000                                 #define  TIM1_CCMR2 $5259  ;
  98  000000                                 #define  TIM1_CCMR3 $525A  ;
  99  000000                                 #define  TIM1_CCMR4  $525B  ;
 100  000000                                 #define  TIM1_CCER1 $525C  ;
 101  000000                                 #define  TIM1_CCER2 $525D  ;
 102  000000                                 #define  TIM1_CNTRH $525E  ;
 103  000000                                 #define  TIM1_CNTRL  $255f  ;
 104  000000                                 #define  TIM1_PSCRH  $5260  ;
 105  000000                                 #define  TIM1_PSCRL $5261  ;
 106  000000                                 #define  TIM1_ARRH  $5262  ;
 107  000000                                 #define  TIM1_ARRL  $5263  ;
 108  000000                                 #define  TIM1_RCR   $5264  ;
 109  000000                                 #define  TIM1_CCR1H $5265  ;
 110  000000                                 #define  TIM1_CCR1L $5266  ;
 111  000000                                 #define  TIM1_CCR2H $5267  ;
 112  000000                                 #define  TIM1_CCR2L $5268  ;
 113  000000                                 #define  TIM1_CCR3H $5269  ;
 114  000000                                 #define  TIM1_CCR3L $526A  ;
 115  000000                                 #define  TIM1_CCR4H  $526B  ;
 116  000000                                 #define  TIM1_CCR4L $526C  ;
 117  000000                                 #define  TIM1_BKR   $526D  ;
 118  000000                                 #define  TIM1_DTR   $526E  ;
 119  000000                                 #define  TIM1_OISR  $526F  ;
 120                                   
 121  000000                                 #define  TIM_CR1_CENTER_ALINGN_1 #$20
 122  000000                                 #define  TIM_CR1_CENTER_ALINGN_2 #$40
 123  000000                                 #define  TIM_CR1_CENTER_ALINGN_3 #$60
 124  000000                                 #define  TIM_CR1_COUNTS_UP #$00
 125  000000                                 #define  TIM_CR1_COUNTS_DOWN #$10
 126  000000                                 #define  TIM_CR1_PRELOAD #$80
 127  000000                                 #define  TIM_CCMR_ACTIVE_ON_MATCH #$10
 128  000000                                 #define  TIM_CCMR_INACTIVE_ON_MATCH #$20
 129  000000                                 #define  TIM_CCMR_TOGGLE   #$30
 130  000000                                 #define  TIM_CCMR_FORCE_INACTIVE #$40 
 131  000000                                 #define  TIM_CCMR_FORCE_ACTIVE   #$50
 132                                                          ;-------------SPI----------
 133  000000                                 #define  SPI_CR1  $5200  ;
 134  000000                                 #define  SPI_CR2 $5201  ;
 135  000000                                 #define  SPI_ICR  $5202  ;
 136  000000                                 #define  SPI_SR        $5203;
 137  000000                                 #define  SPI_DR        $5204;
 138  000000                                 #define  SPI_CRCPR     $5205;
 139  000000                                 #define  SPI_RXCRCR    $5206;
 140  000000                                 #define  SPI_TXCRCR    $5207;
 141                                                          ;---------------I2C----------
 142  000000                                 #define  I2C_CR1       $5210;
 143  000000                                 #define  I2C_CR2       $5211;
 144  000000                                 #define  I2C_FREQR     $5212;
 145  000000                                 #define  I2C_OARL      $5213;
 146  000000                                 #define  I2C_OARH      $5214;
 147  000000                                 #define  I2C_DR        $5216;
 148  000000                                 #define  I2C_SR1       $5217;
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 4  Assembler
                                               d:\stm8\dbg1\main.asm

 149  000000                                 #define  I2C_SR2       $5218;
 150  000000                                 #define  I2C_SR3       $5219;
 151  000000                                 #define  I2C_ITR       $521A;
 152  000000                                 #define  I2C_CCRL      $521B;
 153  000000                                 #define  I2C_CCRH      $521C;
 154  000000                                 #define  I2C_TRISER    $521D;
 155  000000                                 #define  I2C_PECR      $521E;
 156                                                          ;------------UART--------------
 157  000000                                 #define  UART1_SR      $5230;
 158  000000                                 #define  UART1_DR      $5231;
 159  000000                                 #define  UART1_BRR1    $5232;
 160  000000                                 #define  UART1_BRR2    $5233;
 161  000000                                 #define  UART1_CR1     $5234;
 162  000000                                 #define  UART1_CR2     $5235;
 163  000000                                 #define  UART1_CR3     $5236;
 164  000000                                 #define  UART1_CR4     $5237;
 165  000000                                 #define  UART1_CR5     $5238;
 166  000000                                 #define  UART1_GTR     $5239;
 167  000000                                 #define  UART1_PSCR    $523A;
 168                                                          ;----------TIM4----------------
 169  000000                                 #define  TIM4_CR1      $5340;
 170  000000                                 #define  TIM4_IER      $5343;
 171  000000                                 #define  TIM4_SR       $5344;
 172  000000                                 #define  TIM4_EGR      $5345;
 173  000000                                 #define  TIM4_CNTR     $5346;
 174  000000                                 #define  TIM4_PSCR     $5347;
 175  000000                                 #define  TIM4_ARR      $5348;
 176                                                          ;---------ADC1-----------------
 177                                   
 178  000000                                 #define  ADC_CSR       $5400;
 179  000000                                 #define  ADC_CR1       $5401;
 180  000000                                 #define  ADC_CR2       $5402;
 181  000000                                 #define  ADC_CR3       $5403;
 182  000000                                 #define  ADC_DRH       $5404;
 183  000000                                 #define  ADC_DRL       $5405;
 184  000000                                 #define  ADC_TDRH      $5406;
 185  000000                                 #define  ADC_TDRL      $5407;
 186  000000                                 #define  ADC_HTRH      $5408;
 187  000000                                 #define  ADC_HTRL      $5409;
 188  000000                                 #define  ADC_LTRH      $540A;
 189  000000                                 #define  ADC_LTRL      $540B;
 190  000000                                 #define  ADC_AWSRH     $540C;
 191  000000                                 #define  ADC_AWSRL     $540D;
 192  000000                                 #define  ADC_AWCRH     $540E;
 193  000000                                 #define  ADC_AWCRL     $540F;
 194                                                          ;;buffers
 195  000000                                 #define  ADC_DB0RH     $53E0;
 196  000000                                 #define  ADC_DB0RL     $53E1;
 197  000000                                 #define  ADC_DB1RH     $53E2;
 198  000000                                 #define  ADC_DB1RL     $53E3;
 199  000000                                 #define  ADC_DB2RH     $53E4;
 200  000000                                 #define  ADC_DB2RL     $53E5;
 201  000000                                 #define  ADC_DB3RH     $53E6;
 202  000000                                 #define  ADC_DB3RL     $53E7;
 203  000000                                 #define  ADC_DB4RH     $53E8;
 204  000000                                 #define  ADC_DB4RL     $53E9;
 205  000000                                 #define  ADC_DB5RH     $53EA;
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 5  Assembler
                                               d:\stm8\dbg1\main.asm

 206  000000                                 #define  ADC_DB5RL     $53EB;
 207  000000                                 #define  ADC_DB6RH     $53EC;
 208  000000                                 #define  ADC_DB6RL     $53ED;
 209  000000                                 #define  ADC_DB7RH     $53EC;
 210  000000                                 #define  ADC_DB7RL     $53ED;
 211  000000                                 #define  ADC_DB8RH     $53EC;
 212  000000                                 #define  ADC_DB8RL     $53ED;
 213                                   
 214                                   
 215                                                          ;----------TIM2----------
 216  000000                                 #define  TIM2_CR1      $5300;
 217  000000                                 #define  TIM2_IER      $5303;
 218  000000                                 #define  TIM2_SR1      $5304;
 219  000000                                 #define  TIM2_SR2      $5305;
 220  000000                                 #define  TIM2_EGR      $5306;
 221  000000                                 #define  TIM2_CCMR1    $5307;
 222  000000                                 #define  TIM2_CCMR2    $5308;
 223  000000                                 #define  TIM2_CCMR3    $5309;
 224  000000                                 #define  TIM2_CCER1    $530A;
 225  000000                                 #define  TIM2_CCER2    $530B;
 226  000000                                 #define  TIM2_CNTRH    $530C;
 227  000000                                 #define  TIM2_CNTRL  $530D  ;
 228  000000                                 #define  TIM2_PSCR     $530E;
 229  000000                                 #define  TIM2_ARRH     $530F;
 230  000000                                 #define  TIM2_ARRL     $5310;
 231  000000                                 #define  TIM2_CCR1H    $5311;
 232  000000                                 #define  TIM2_CCR1L    $5312;
 233  000000                                 #define  TIM2_CCR2H      $5313  ;
 234  000000                                 #define  TIM2_CCR2L    $5314;
 235  000000                                 #define  TIM2_CCR3H    $5315;
 236  000000                                 #define  TIM2_CCR3L    $5316;
 237                                   
 238                                   
<END_OF_INCLUSION>
   5                                   
   6                                   segment  at 0000 'USER_RAM'
   7                                                          ;--USER VARIABLES--
   8                                                          ;pointer for receiver	$0000
   9  000000                       _RxPtr_   equ      $0000
  10                                                          ;pointer for transmitter $0002
  11  000002                       _TxPtr_   equ      $0002
  12                                                          ; bit0-sybol has been received
  13                                                          ; bit1 - it is a sybol for 
                                                                ;transmission
  14  000004                       _semaphore  equ      $0004
  15                                                          ;bufers for transmission and 
                                                                ;reception
  16  000010                       _RxBuffer32  equ      $0010
  17  000000                                 #define  _RxBuffer32_end $002f   ;last element
  18  000030                       _TxBuffer32  equ      $0030
  19  000000                                 #define  _TxBuffer32_end $004f   ; last element
  20  000050                       _received_char  equ      $0050
  21                                                          ;stringbuffer $0004
  22  000051                       str1      equ      $0051         
  23                                                          ;-----------------
  24                                   segment  'rom'     
  25  008080   5F505554494E2048    
  25  008088   554A4C4F0A0D        _hello    STRING   "_PUTIN HUJLO",'\n','\r'
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 6  Assembler
                                               d:\stm8\dbg1\main.asm

  26                         
  27                         main.l    
  28                                                          ; initialize SP
  29  00808E   AE03FF                        ldw      X,#stack_end
  30  008091   94                            ldw      SP,X
  31                         
  32  008092                                 #ifdef   1             
  33                                                          ; clear RAM0
  34  000000                       ram0_start.b  EQU      $0
  35  0000FF                       ram0_end.b  EQU      $FF
  36  008092   AE0000                        ldw      X,#ram0_start
  37                         clear_ram0.l  
  38  008095   7F                            clr      (X)
  39  008096   5C                            incw     X
  40  008097   A300FF                        cpw      X,#ram0_end   
  41  00809A   23F9                          jrule    clear_ram0
  42  00809C                                 #endif   
  43                         
  44  00809C                                 #ifdef   1
  45                                                          ; clear RAM1
  46  000100                       ram1_start.w  EQU      $100
  47  0001FF                       ram1_end.w  EQU      $1FF          
  48  00809C   AE0100                        ldw      X,#ram1_start
  49                         clear_ram1.l  
  50  00809F   7F                            clr      (X)
  51  0080A0   5C                            incw     X
  52  0080A1   A301FF                        cpw      X,#ram1_end   
  53  0080A4   23F9                          jrule    clear_ram1
  54  0080A6                                 #endif   
  55                         
  56                                                          ; clear stack
  57  000200                       stack_start.w  EQU      $200
  58  0003FF                       stack_end.w  EQU      $3FF
  59  0080A6   AE0200                        ldw      X,#stack_start
  60                         clear_stack.l  
  61  0080A9   7F                            clr      (X)
  62  0080AA   5C                            incw     X
  63  0080AB   A303FF                        cpw      X,#stack_end  
  64  0080AE   23F9                          jrule    clear_stack
  65                         ;______________________________________
  66                         ;  _   _ ___  ___ _ __   _ __ ___   __ _(_)_ __  
  67                         ; | | | / __|/ _ \ '__| | '_ ` _ \ / _` | | '_ \ 
  68                         ; | |_| \__ \  __/ |    | | | | | | (_| | | | | |
  69                         ;  \__,_|___/\___|_|    |_| |_| |_|\__,_|_|_| |_|
  70                         
  71  0080B0   AE0030                        LDW      X, #_TxBuffer32  ;
  72                         ;--global pointer UART Rx bufffer init
  73                         ;[*P=$0000][$0002...$0012]
  74  0080B3   B651                          LD       A, str1       ;
  75  0080B5   AE0002                        LDW      X, #$0002
  76  0080B8   BF00                          LDW      $0000, X
  77  0080BA   A600                          LD       A, #$00
  78  0080BC   88                            PUSH     A
  79  0080BD   CD8250                        CALL     clkSetHsiDivider
  80  0080C0   84                            POP      A
  81  0080C1   A6FF                          LD       A, #$FF
  82  0080C3   C750C7                        LD       $50C7, A
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 7  Assembler
                                               d:\stm8\dbg1\main.asm

  83  0080C6   A68A                          LD       A, #$8A
  84  0080C8   C750CA                        LD       $50CA, A
  85                                                          ;--turn on quartz
  86  0080CB   CD8235                        CALL     clkSwitchToCrystal
  87                                   
  88                                                          ;--PC3,4-output 
  89  0080CE   A638                          LD       A, #$38       ; 3,4,5 
  90  0080D0   C7500C                        LD       $500C, A
  91  0080D3   C7500D                        LD       $500D, A
  92  0080D6   C7500E                        LD       $500E, A
  93                                                          ;--PA3
  94  0080D9   A600                          LD       A, #$00       ;  
  95  0080DB   C75002                        LD       $5002, A
  96  0080DE   C75003                        LD       $5003, A
  97  0080E1   C75004                        LD       $5004, A
  98                                                          ;--D
  99  0080E4   A620                          LD       A, #$20       ;  
 100  0080E6   C75011                        LD       $5011, A      ;   PD5 output,
 101  0080E9   721A500F                      BSET     $500F, #$05   ; high level PD5 
 102  0080ED   C75012                        LD       $5012, A      ; push-pull,
 103  0080F0   C75012                        LD       $5012, A      ; up to 10MHz.
 104                                                          ;dumy delay
 105  0080F3   9D                            NOP      
 106  0080F4   9D                            NOP      
 107  0080F5   9D                            NOP      
 108                                   
 109                                   
 110                                                          ;@baudRate16, divider
 111  0080F6   AE0209                        LDW      X, #$0209
 112  0080F9   89                            PUSHW    X
 113                         ;@dataLength8, ;
 114                                                          ;$10->9bits (1stop 1 start) 
 115                                                          ;, $00->8bits (set  ;manually 
                                                                ;below)
 116  0080FA   A600                          LD       A, #$00
 117  0080FC   88                            PUSH     A
 118                         ;@stopBits8  $00->1bit, $20->2bits
 119  0080FD   A600                          LD       A, #$00
 120  0080FF   88                            PUSH     A
 121  008100   A600                          LD       A, #$00       ;@parity8, $00-disable, 
 122                                                          ;$04-enable: ($02-odd OR 
                                                                ;$00-even)
 123  008102   88                            PUSH     A
 124  008103   CD81D2                        CALL     uart1DuplexSetupIT
 125                         ;-----------
 126                         ;SP +5
 127  008106   5B05                          ADDW     SP, #$05
 128  008108   A631                          LD       A,#$31
 129  00810A   9D                            nop      
 130  00810B   9D                            nop      
 131  00810C   9D                            nop      
 132  00810D   9D                            nop      
 133                         
 134                                   
 135                                   
 136                                                          ;--L     o o    Pppp
 137                                                          ;  L    o   o   P   p
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 8  Assembler
                                               d:\stm8\dbg1\main.asm

 138                                                          ;  L    o   o   Ppp 
 139                                                          ;  L L   o o    P
 140                                                          ;;init pointers
 141  00810E   AE0010                        LDW      X, #_RxBuffer32
 142  008111   BF00                          LDW      _RxPtr_, X
 143  008113   AE0030                        LDW      X, #_TxBuffer32
 144  008116   BF02                          LDW      _TxPtr_, X
 145                         infinite_loop.l  
 146                                                          ;are there  symbol?
 147  008118   720100041C                    BTJF     _semaphore, #$0, _no_sym_reeived
 148                                                          ;when symbol received:
 149  00811D   72110004                      BRES     _semaphore, #$0   ;clear semaphore
 150  008121   BE00                          LDW      X, _RxPtr_    ; load a pointer
 151  008123   B650                          LD       A, _received_char   ;read symbol from Rx
 152  008125   F7                            LD       (X), A        ; store symbol in an arrray
 153                                                          ;when the symbol last - assign 
                                                                ;to pointer first cell
 154  008126   9093                          LDW      Y, X
 155  008128   72A2002F                      SUBW     Y, #$002f 
 156  00812C   2706                          JREQ     _last_rx_item
 157                                                          ;when character (byte) not last 
                                                                ;- increment & store pointer
 158  00812E   5C                            INCW     X
 159  00812F   BF00                          LDW      _RxPtr_, X
 160  008131   CC8139                        JP       _no_sym_reeived    
 161                         _last_rx_item  
 162                                                          ;when the symbol is  last - 
                                                                ;clear pointer
 163  008134   AE0010                        LDW      X, #_RxBuffer32
 164  008137   BF00                          LDW      _RxPtr_, X
 165                                                          ;LD UART1_DR, A
 166                         _no_sym_reeived  
 167                         
 168  008139   8F                            WFI      
 169  00813A   20DC                          jra      infinite_loop
 170                                   
 171                         
 172                                   
 173                         
 174                         ;------------------------------	
 175                         ;  _            _   
 176                         ; | |_ ___  ___| |_ 
 177                         ; | __/ _ \/ __| __|
 178                         ; | ||  __/\__ \ |_ 
 179                         ;  \__\___||___/\__|
 180                         ;-------------------------------
 181                         
 182                         ;==PROCEDURE==uart1ReceiverSetup
 183                         ;@baudRate16, divider
 184                         ;@dataLength8, $10->9bits (1stop 1 start) , $00->8bits
 185                                                          ;(set  manually below)
 186                         ;@stopBits8, active only when 8 bits: $00->1bit, $20->2bits
 187                         ;@parity8, $00-disable, $04-enable: ($02-odd OR $00-even)
 188                         ;-----------
 189                         ;SP +5
 190                         ;  0  1 2 4    5         6      7      8 
 191                         ;[v8a|A|RET|stopBits|dataLength|baudRate]
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 9  Assembler
                                               d:\stm8\dbg1\main.asm

 192                         
 193                         uart1ReceiverSetup  
 194                                                          ;--store A
 195  00813C   88                            PUSH     A
 196                                                          ;--allocate 1 byte
 197  00813D   5201                          SUBW     SP, #$01
 198  00813F                                 #define  _U1000_v8a $00 
 199  00813F                                 #define  _U1000_parity $05
 200  00813F                                 #define  _U1000_stopBits $06 
 201  00813F                                 #define  _U1000_dataLength $07
 202  00813F                                 #define  _U1000_baudRateH $08
 203  00813F                                 #define  _U1000_baudRateL $09
 204                                                          ;--disable Rx, Tx
 205  00813F   72155235                      BRES     $5235, #$2    ; REN flag
 206  008143   72175235                      BRES     $5235, #$3    ; TEN flag
 207                                                          ;--when the length 9 bits-jump 
                                                                ;below
 208  008147   A610                          LD       A, #$10
 209  008149   1407                          AND      A, ($07,SP)
 210  00814B   2605                          JRNE     L_U1000_nsb   ;when 9 bits-go to label
 211                                                          ;--when 8 bit set stop bits
 212  00814D   7B06                          LD       A, ($06,SP)
 213  00814F   C75236                        LD       $5236, A
 214                         L_U1000_nsb  
 215                                                          ;--write data length and parity
 216  008152   7B07                          LD       A,($07,SP)
 217  008154   1A05                          OR       A, ($05,SP)
 218  008156   C75234                        LD       $5234, A
 219                                                          ;prepare UART1_BRR2
 220                                                          ;n4 n1
 221  008159   7B09                          LD       A, ($09,SP)
 222  00815B   A40F                          AND      A, #$0F       ;
 223  00815D   6B00                          LD       ( $00,SP),A   ; store nibble 1
 224  00815F   7B08                          LD       A, ($08,SP)
 225  008161   A4F0                          AND      A, #$f0       ; nibble 4
 226  008163   1A00                          OR       A, ($00,SP)   ; n4+n1
 227  008165   6B00                          LD       ( $00,SP),A   ; store BRR2 [n4,n1]
 228                                                          ;;--send -TO REGISTER BRR2
 229  008167   C75233                        LD       $5233 , A
 230                                                          ;----n3 n2
 231  00816A   7B08                          LD       A, ($08,SP)
 232  00816C   4E                            SWAP     A
 233  00816D   A4F0                          AND      A, #$F0
 234  00816F   6B00                          LD       ( $00,SP),A   ; store n3
 235  008171   7B09                          LD       A, ($09,SP)
 236  008173   4E                            SWAP     A
 237  008174   A40F                          AND      A, #$0f
 238  008176   1A00                          OR       A, ( $00,SP)
 239                                                          ;--send to register BRR1
 240  008178   C75232                        LD       $5232, A
 241                                                          ; RIEN interrupt on receive
 242  00817B   721A5235                      BSET     $5235, #$5 
 243                                                          ;--setting REN bit "Receiver 
                                                                ;enable"
 244  00817F   72145235                      BSET     $5235 , #$2
 245                                                          ;--restore stack
 246  008183   5B01                          ADDW     SP, #$01
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 10  Assembler
                                               d:\stm8\dbg1\main.asm

 247  008185   84                            POP      A
 248  008186   81                            RET      
 249                                                          ;==PROCEDURE==uart1TransmitterSe
                                                                ;tup
 250                                   
 251                         ;@baudRate16, divider
 252                         ;@dataLength8, $10->9bits (1stop 1 start) , $00->8bits
 253                                                          ;(set  manually below)
 254                         ;@stopBits8, active only when 8 bits: $00->1bit, $20->2bits
 255                         ;@parity8, $00-disable, $04-enable: ($02-odd OR $00-even)
 256                         ;-----------
 257                         ;SP +5
 258                         ;  0  1 2 4    5         6      7      8 
 259                         ;[v8a|A|RET|stopBits|dataLength|baudRate]
 260                         
 261                         uart1TransmitterSetup  
 262                                                          ;--store A
 263  008187   88                            PUSH     A
 264                                                          ;--allocate 1 byte
 265  008188   5201                          SUBW     SP, #$01
 266  00818A                                 #define  _U1001_v8a $00 
 267  00818A                                 #define  _U1001_parity $05
 268  00818A                                 #define  _U1001_stopBits $06 
 269  00818A                                 #define  _U1001_dataLength $07
 270  00818A                                 #define  _U1001_baudRateH $08
 271  00818A                                 #define  _U1001_baudRateL $09
 272                                                          ;--disable Rx, Tx
 273  00818A   72155235                      BRES     $5235, #$2    ; REN flag
 274  00818E   72175235                      BRES     $5235, #$3    ; TEN flag
 275                                                          ;--when the length 9 bits-jump 
                                                                ;below
 276  008192   A610                          LD       A, #$10
 277  008194   1407                          AND      A, ($07,SP)
 278  008196   2605                          JRNE     L_U1001_nsb   ;when 9 bits-go to label
 279                                                          ;--when 8 bit set stop bits
 280  008198   7B06                          LD       A, ($06,SP)
 281  00819A   C75236                        LD       $5236, A
 282                         L_U1001_nsb  
 283                                                          ;--write data length and parity
 284  00819D   7B07                          LD       A,($07,SP)
 285  00819F   1A05                          OR       A, ($05,SP)
 286  0081A1   C75234                        LD       $5234, A
 287                                                          ;prepare UART1_BRR2
 288                                                          ;n4 n1
 289  0081A4   7B09                          LD       A, ($09,SP)
 290  0081A6   A40F                          AND      A, #$0F       ;
 291  0081A8   6B00                          LD       ( $00,SP),A   ; store nibble 1
 292  0081AA   7B08                          LD       A, ($08,SP)
 293  0081AC   A4F0                          AND      A, #$f0       ; nibble 4
 294  0081AE   1A00                          OR       A, ($00,SP)   ; n4+n1
 295  0081B0   6B00                          LD       ( $00,SP),A   ; store BRR2 [n4,n1]
 296                                                          ;;--send -TO REGISTER BRR2
 297  0081B2   C75233                        LD       $5233 , A
 298                                                          ;----n3 n2
 299  0081B5   7B08                          LD       A, ($08,SP)
 300  0081B7   4E                            SWAP     A
 301  0081B8   A4F0                          AND      A, #$F0
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 11  Assembler
                                               d:\stm8\dbg1\main.asm

 302  0081BA   6B00                          LD       ( $00,SP),A   ; store n3
 303  0081BC   7B09                          LD       A, ($09,SP)
 304  0081BE   4E                            SWAP     A
 305  0081BF   A40F                          AND      A, #$0f
 306  0081C1   1A00                          OR       A, ( $00,SP)
 307                                                          ;--send to register BRR1
 308  0081C3   C75232                        LD       $5232, A
 309                                                          ; TCIEN interrupt on tx 
                                                                ;complete
 310  0081C6   721C5235                      BSET     $5235, #$6 
 311                                                          ;--setting TEN bit "Transmitter 
                                                                ;enable"
 312  0081CA   72165235                      BSET     $5235 , #$3
 313                                                          ;--restore stack
 314  0081CE   5B01                          ADDW     SP, #$01
 315  0081D0   84                            POP      A
 316  0081D1   81                            RET      
 317                         ;==PROCEDURE==uart1DuplexSetupIT
 318                         ;--set up Receiver and Transmitter
 319                         ; Turn on  TC, RXNE interrupts.
 320                         ;---------------------
 321                         ;@baudRate16, divider
 322                         ;@dataLength8, $10->9bits (1stop 1 start) , $00->8bits
 323                                                          ;(set  manually below)
 324                         ;@stopBits8, active only when 8 bits: $00->1bit, $20->2bits
 325                         ;@parity8, $00-disable, $04-enable: ($02-odd OR $00-even)
 326                         ;-----------
 327                         ;SP +5
 328                         ;  0  1 2 4    5         6      7      8 
 329                         ;[v8a|A|RET|stopBits|dataLength|baudRate]
 330                         
 331                         uart1DuplexSetupIT  
 332                                                          ;--store A
 333  0081D2   88                            PUSH     A
 334                                                          ;--allocate 1 byte
 335  0081D3   5201                          SUBW     SP, #$01
 336  0081D5                                 #define  _U1003_v8a $00 
 337  0081D5                                 #define  _U1003_parity $05
 338  0081D5                                 #define  _U1003_stopBits $06 
 339  0081D5                                 #define  _U1003_dataLength $07
 340  0081D5                                 #define  _U1003_baudRateH $08
 341  0081D5                                 #define  _U1003_baudRateL $09
 342                                                          ;--disable Rx, Tx
 343  0081D5   72155235                      BRES     $5235, #$2    ; REN flag
 344  0081D9   72175235                      BRES     $5235, #$3    ; TEN flag
 345                                                          ;--when the length 9 bits-jump 
                                                                ;below
 346  0081DD   A610                          LD       A, #$10
 347  0081DF   1407                          AND      A, ($07,SP)
 348  0081E1   2605                          JRNE     L_U1003_nsb   ;when 9 bits-go to label
 349                                                          ;--when 8 bit set stop bits
 350  0081E3   7B06                          LD       A, ($06,SP)
 351  0081E5   C75236                        LD       $5236, A
 352                         L_U1003_nsb  
 353                                                          ;--write data length and parity
 354  0081E8   7B07                          LD       A,($07,SP)
 355  0081EA   1A05                          OR       A, ($05,SP)
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 12  Assembler
                                               d:\stm8\dbg1\main.asm

 356  0081EC   C75234                        LD       $5234, A
 357                                                          ;prepare UART1_BRR2
 358                                                          ;n4 n1
 359  0081EF   7B09                          LD       A, ($09,SP)
 360  0081F1   A40F                          AND      A, #$0F       ;
 361  0081F3   6B00                          LD       ( $00,SP),A   ; store nibble 1
 362  0081F5   7B08                          LD       A, ($08,SP)
 363  0081F7   A4F0                          AND      A, #$f0       ; nibble 4
 364  0081F9   1A00                          OR       A, ($00,SP)   ; n4+n1
 365  0081FB   6B00                          LD       ( $00,SP),A   ; store BRR2 [n4,n1]
 366                                                          ;;--send -TO REGISTER BRR2
 367  0081FD   C75233                        LD       $5233 , A
 368                                                          ;----n3 n2
 369  008200   7B08                          LD       A, ($08,SP)
 370  008202   4E                            SWAP     A
 371  008203   A4F0                          AND      A, #$F0
 372  008205   6B00                          LD       ( $00,SP),A   ; store n3
 373  008207   7B09                          LD       A, ($09,SP)
 374  008209   4E                            SWAP     A
 375  00820A   A40F                          AND      A, #$0f
 376  00820C   1A00                          OR       A, ( $00,SP)
 377                                                          ;--send to register BRR1
 378  00820E   C75232                        LD       $5232, A
 379                                                          ;turn on interrupt on tx 
                                                                ;complete, Rx not empty
 380  008211   721C5235                      BSET     $5235, #$6    ; TCIEN
 381  008215   721A5235                      BSET     $5235, #$5    ; RIEN
 382                                                          ;--set  "Transmitter enable", 
                                                                ;"receiver enable"
 383  008219   72165235                      BSET     $5235 , #$3
 384  00821D   72145235                      BSET     $5235 , #$2
 385                                                          ;--restore stack
 386  008221   5B01                          ADDW     SP, #$01
 387  008223   84                            POP      A
 388  008224   81                            RET      
 389                                                          ;====P R O C E D U R E===turn on
                                                                ; clk bus
 390                                                          ;@peripherial8
 391                                                          ;TIM1-$80,TIM3-$40,TIM2/5-$20,TI
                                                                ;M4/6-$10,UART-see datasheet,
 392                                                          ;SPI-$2,I2C-1
 393                                                          ;STACK after return +1
 394                         clkBusPeripherial1  
 395  008225   88                            PUSH     A
 396  008226   7B04                          LD       A, ($04,SP)
 397  008228   C750C7                        LD       $50C7, A
 398  00822B   84                            POP      A
 399  00822C   81                            RET      
 400                                                          ;====P R O C E D U R E===turn on
                                                                ; clk bus
 401                                                          ;@peripherial8
 402                                                          ;CAN-$80, ADC-$08, AWU-$04
 403                                                          ;STACK after return +1
 404                         clkBusPeripherial2  
 405  00822D   88                            PUSH     A
 406  00822E   7B04                          LD       A, ($04,SP)
 407  008230   C750CA                        LD       $50CA, A
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 13  Assembler
                                               d:\stm8\dbg1\main.asm

 408  008233   84                            POP      A
 409  008234   81                            RET      
 410                                                          ;===P R O C E D U R E=switch to 
                                                                ;Crystal
 411                                                          ;--NO PARAMS
 412                                                          ;STACK after return 0
 413                         clkSwitchToCrystal  
 414  008235   88                            PUSH     A
 415                                                          ;--tuurn on HSE oscillator
 416  008236   A601                          LD       A, #$01
 417  008238   C750C1                        LD       $50C1, A
 418                         clkSwitchToCrystal_hsi_rdy  
 419                                                          ;--wait until crystal oscillator
                                                                ; ready (HSERDY)
 420  00823B   720350C1FB                    BTJF     $50C1, #$01, clkSwitchToCrystal_hsi_rdy
 421                                                          ;---Enable the switching 
                                                                ;mechanism
 422  008240   C650C5                        LD       A, $50C5
 423  008243   AA02                          OR       A, #$02
 424  008245   C750C5                        LD       $50C5, A
 425                                                          ;---select source clock
 426                                                          ;0xE1: HSI selected as master 
                                                                ;clock source (reset value)
 427                                                          ;0xD2: LSI selected as master 
                                                                ;clock source (only if LSI_EN
 428                                                          ;option bit is set)
 429                                                          ;0xB4: HSE selected as master 
                                                                ;clock source
 430  008248   A6B4                          LD       A, #$B4
 431  00824A   C750C4                        LD       $50C4, A
 432  00824D   9D                            NOP      
 433  00824E   84                            POP      A
 434  00824F   81                            RET      
 435                                   
 436                                   
 437                                                          ;==P R O C E D U R E=="set HSI 
                                                                ;divider"
 438                                                          ;--@ char divider
 439                                                          ;STACK after return +1
 440                         clkSetHsiDivider  
 441                                                          ;--store registers A,X,Y,CC 
                                                                ;(1+2+2+1=6Bytes)
 442  008250   88                            PUSH     A
 443                                                          ;-read default value 
 444  008251   C650C6                        LD       A, $50C6
 445                                                          ;---clear all the hsi divider 
                                                                ;bits
 446  008254   A4E7                          AND      A, #$E7
 447                                                          ;--1st paprameter has offset 9 
                                                                ;bytes
 448                                                          ; because A,X,Y,CC,SP has ben 
                                                                ;stored later 
 449  008256   1A04                          OR       A, ($04,SP)
 450                                                          ;---update CLK_CKDIVR
 451  008258   C750C6                        LD       $50C6, A
 452                                                          ;--restore registers
 453  00825B   84                            POP      A
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 14  Assembler
                                               d:\stm8\dbg1\main.asm

 454  00825C   81                            RET      
 455                                   
 456                                                          ;======P R O C e D U R E==="set 
                                                                ;CPU divider"
 457                                                          ;@ char divider 
 458                                                          ;STACK after return +1
 459                         clkSetCpuDivider  
 460                                                          ;--store registers A,X,Y,CC 
                                                                ;(1+2+2+1=6Bytes)
 461  00825D   88                            PUSH     A
 462                                                          ;-read default value 
 463  00825E   C650C6                        LD       A, $50C6
 464                                                          ;---clear all the hsi divider 
                                                                ;bits
 465  008261   A4F8                          AND      A, #$f8
 466                                                          ;--1st paprameter has offset 9 
                                                                ;bytes
 467                                                          ; because A,X,Y,CC,SP has ben 
                                                                ;stored later
 468  008263   1A04                          OR       A, ($04,SP)
 469                                                          ;---update CLK_CKDIVR
 470  008265   C750C6                        LD       $50C6, A
 471                                                          ;--restore registers
 472  008268   84                            POP      A
 473  008269   81                            RET      
 474                                   
 475                                   
 476                                   
 477                         ;------I  S  R----------
 478                         
 479                         tim4Isr   
 480  00826A   80                            IRET     
 481                                   
 482                                   
 483                                   
 484                         onTim1Update  
 485  00826B   80                            IRET     
 486                         
 487                         uart1OnReceive  
 488  00826C   7216500A                      BSET     $500A, #$3
 489  008270   C65231                        LD       A, $5231 
 490  008273   72100004                      BSET     _semaphore, #$0   ;;set semaphore
 491  008277   B750                          LD       _received_char, A   ;store symbol for echo
 492                                                          ;--test on errors
 493  008279   C65230                        LD       A, $5230
 494  00827C   A40F                          AND      A, #$0F
 495  00827E   721B500A                      BRES     $500A, #$5    ;turn OFF error LED
 496  008282   2704                          JREQ     _NO_ERR_RX    ; ? are there no errors?
 497  008284   721A500A                      BSET     $500A, #$5    ;turn ON error LED
 498                         _NO_ERR_RX  
 499                                                          ;when data has been transmitted
 500  008288   720D523005                    BTJF     $5230, #$6, NO_DATA_IN_TC
 501                         WAIT_UNTIL_TC  
 502                                                          ;wait until transmission 
                                                                ;complete
 503  00828D   720D5230FB                    BTJF     $5230, #$6, WAIT_UNTIL_TC
 504                         NO_DATA_IN_TC  
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 15  Assembler
                                               d:\stm8\dbg1\main.asm

 505  008292   9D                            NOP      
 506                         
 507  008293   7217500A                      BRES     $500A, #$3
 508  008297   9D                            NOP      
 509  008298   80                            IRET     
 510                                   
 511                                   
 512                         uart1OnTransmit  
 513  008299   7218500A                      BSET     $500A, #$4
 514  00829D   721F500A                      BRES     $500A, #$7
 515  0082A1   C65230                        LD       A, $5230
 516  0082A4   721D5230                      BRES     $5230, #$6
 517  0082A8   721F5230                      BRES     $5230, #$7
 518                                                          ;--test on errors
 519  0082AC   A40F                          AND      A, #$0F
 520  0082AE   721B500A                      BRES     $500A, #$5    ;turn OFF error LED
 521  0082B2   2704                          JREQ     _NO_ERR_TX    ; ? are there no errors?
 522  0082B4   721A500A                      BSET     $500A, #$5    ;turn ON error LED
 523                         _NO_ERR_TX  
 524  0082B8   9D                            NOP      
 525  0082B9   9D                            NOP      
 526  0082BA   7219500A                      BRES     $500A, #$4
 527  0082BE   80                            IRET     
 528                         
 529                         
 530  0082BF                                 interrupt NonHandledInterrupt
 531                         NonHandledInterrupt.l  
 532  0082BF   80                            iret     
 533                                   segment  'vectit'
 534  008000   8200808E                      dc.l     {$82000000+main}  ; reset
 535  008004   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; trap
 536  008008   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq0
 537  00800C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq1
 538  008010   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq2
 539  008014   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq3
 540  008018   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq4
 541  00801C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq5
 542  008020   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq6
 543  008024   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq7
 544  008028   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq8
 545  00802C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq9
 546  008030   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq10
 547  008034   8200826B                      dc.l     {$82000000+onTim1Update}  ; irq11
 548  008038   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq12
 549  00803C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq13
 550  008040   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq14
 551  008044   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq15
 552  008048   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq16
 553  00804C   82008299                      dc.l     {$82000000+uart1OnTransmit}  ; irq17
 554  008050   8200826C                      dc.l     {$82000000+uart1OnReceive}  ; irq18
 555  008054   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq19
 556  008058   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq20
 557  00805C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq21
 558  008060   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq22
 559  008064   8200826A                      dc.l     {$82000000+tim4Isr}  ; irq23
 560  008068   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq24
 561  00806C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq25
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 16  Assembler
                                               d:\stm8\dbg1\main.asm

 562  008070   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq26
 563  008074   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq27
 564  008078   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq28
 565  00807C   820082BF                      dc.l     {$82000000+NonHandledInterrupt}  ; irq29
 566                         
 567  008080                                 end      
STMicroelectronics list file postprocessor v1.01   (C)2009-2024   Sat Aug 31 22:10:56 2024
Page 17  Assembler
                                               d:\stm8\dbg1\main.asm

Symbol Name                       Value     Call       Type  Scope      Rel.  Line  Privacy  Segment   Size  Bytes File

L_U1000_nsb                           8152         no  WORD  Internal   ABS    214  private  textdata    53     0  -
L_U1001_nsb                           819D         no  WORD  Internal   ABS    282  private  textdata    53     0  -
L_U1003_nsb                           81E8         no  WORD  Internal   ABS    352  private  textdata    61     0  -

NO_DATA_IN_TC                         8292         no  WORD  Internal   ABS    504  private  textdata     7     0  -
NonHandledInterrupt               000082BF  interrupt  LONG  Internal   ABS    531  private  textdata     1     0  -

WAIT_UNTIL_TC                         828D         no  WORD  Internal   ABS    501  private  textdata     5     0  -

_RxPtr_                               0000         no  WORD  Internal   ABS      9  private  undef        0     0  -
_TxPtr_                               0002         no  WORD  Internal   ABS     11  private  undef        0     0  -
_semaphore                            0004         no  WORD  Internal   ABS     14  private  undef        0     0  -
_RxBuffer32                           0010         no  WORD  Internal   ABS     16  private  undef        0     0  -
_TxBuffer32                           0030         no  WORD  Internal   ABS     18  private  undef        0     0  -
_received_char                        0050         no  WORD  Internal   ABS     20  private  undef        0     0  -
_hello                                8080         no  WORD  Internal   ABS     25  private  textdata    14     1  -
_last_rx_item                         8134         no  WORD  Internal   ABS    161  private  textdata     5     0  -
_no_sym_reeived                       8139         no  WORD  Internal   ABS    166  private  textdata     3     0  -
_NO_ERR_RX                            8288         no  WORD  Internal   ABS    498  private  textdata     5     0  -
_NO_ERR_TX                            82B8         no  WORD  Internal   ABS    523  private  textdata     7     0  -

clear_ram0                        00008095         no  LONG  Internal   ABS     37  private  textdata    10     0  -
clear_ram1                        0000809F         no  LONG  Internal   ABS     49  private  textdata    10     0  -
clear_stack                       000080A9         no  LONG  Internal   ABS     60  private  textdata   111     0  -
clkBusPeripherial1                    8225         no  WORD  Internal   ABS    394  private  textdata     8     0  -
clkBusPeripherial2                    822D         no  WORD  Internal   ABS    404  private  textdata     8     0  -
clkSwitchToCrystal                    8235         no  WORD  Internal   ABS    413  private  textdata     6     0  -
clkSwitchToCrystal_hsi_rdy            823B         no  WORD  Internal   ABS    418  private  textdata    21     0  -
clkSetHsiDivider                      8250         no  WORD  Internal   ABS    440  private  textdata    13     0  -
clkSetCpuDivider                      825D         no  WORD  Internal   ABS    459  private  textdata    13     0  -

infinite_loop                     00008118         no  LONG  Internal   ABS    145  private  textdata    28     0  -

main                              0000808E         no  LONG  Internal   ABS     27  private  textdata     7     0  -

onTim1Update                          826B         no  WORD  Internal   ABS    484  private  textdata     1     0  -

ram0_start                              00         no  BYTE  Internal   ABS     34  private  textdata     0     0  -
ram0_end                                FF         no  BYTE  Internal   ABS     35  private  textdata     0     0  -
ram1_start                            0100         no  WORD  Internal   ABS     46  private  textdata     0     0  -
ram1_end                              01FF         no  WORD  Internal   ABS     47  private  textdata     0     0  -

str1                                  0051         no  WORD  Internal   ABS     22  private  undef        0     0  -
stack_start                           0200         no  WORD  Internal   ABS     57  private  textdata     0     0  -
stack_end                             03FF         no  WORD  Internal   ABS     58  private  textdata     0     0  -

tim4Isr                               826A         no  WORD  Internal   ABS    479  private  textdata     1     0  -

uart1ReceiverSetup                    813C         no  WORD  Internal   ABS    193  private  textdata    22     0  -
uart1TransmitterSetup                 8187         no  WORD  Internal   ABS    261  private  textdata    22     0  -
uart1DuplexSetupIT                    81D2         no  WORD  Internal   ABS    331  private  textdata    22     0  -
uart1OnReceive                        826C         no  WORD  Internal   ABS    487  private  textdata    28     0  -
uart1OnTransmit                       8299         no  WORD  Internal   ABS    512  private  textdata    31     0  -


42 labels
No errors on assembly of 'd:\stm8\dbg1\main.asm'